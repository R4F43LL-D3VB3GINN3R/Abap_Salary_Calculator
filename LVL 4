REPORT ZESTUDOS1.

"--------------------------"
"--------------------------"
"   DECLARANDO VARIÁVEIS   "
"--------------------------"
"--------------------------"

"PRIMEIRAMENTE CRIAMOS UMA ESTRUTURA QUE SERVIRÁ DE REFERÊNCIA PARA A MINHA ESTRUTURA LOCAL.
"NELA, MINHAS VARIÁVEIS SÃO ADICIONADAS DE ACORDO COM AS NECESSIDADES QUE VÃO SURGINDO NO DECORRER DA CONSTRUÇÃO DO PROGRAMA.

TYPES:BEGIN OF GS_SEGSOC,               "ESTRUTURA GLOBAL"
        LV_NOME      TYPE C LENGTH  20, "NOME DO FUNCIONÁRIO"
        LV_SALBASE   TYPE P DECIMALS 2, "SALÁRIO BASE"
        LV_SALBRUTO  TYPE P DECIMALS 2, "SALÁRIO BRUTO"
        LV_SALIQ     TYPE P DECIMALS 2, "SALÁRIO LÍQUIDO"
        LV_SEGSOC    TYPE P DECIMALS 2, "SEGURANÇA SOCIAL"
        LV_PENSAO    TYPE C LENGTH  15, "PENSÃO OU APOSENTADORIA"
        LV_TIPOCONTR TYPE C LENGTH  20, "TIPO DE CONTRATO = CONTRATO OU RECIBO VERDE"
        LV_SUBDES    TYPE C LENGTH  20, "SUBSÍDIO DESEMPREGO"
        LV_VALSUB    TYPE P DECIMALS 2, "VALOR DO SUBSÍDIO DESEMPREGO"
        LV_TEMSUB    TYPE C LENGTH  15, "TEMPO DO SUBSÍDIO"
        LV_PLANSAU   TYPE C LENGTH  15, "PLANO PRIVADO DE SAÚDE"
        LV_CONTRSIN  TYPE C LENGTH  15, "CONTRIBUIÇÃO SINDICAL"
        LV_VALEREF   TYPE C LENGTH  15, "VALE REFEIÇÃO"
        LV_VALETRS   TYPE C LENGTH  15, "VALE TRANSPORTE"
        LV_HORAEXTR  TYPE P DECIMALS 2, "HORAS EXTRAS"
        LV_DEDUCT    TYPE P DECIMALS 2, "TOTAL DE DEDUÇÕES"
      END OF GS_SEGSOC.

"A PARTIR DO QUE TEMOS ACIMA, FOI CRIADA ENTÃO UMA ESTRUTURA LOCAL QUE TEM COMO ESCOPO A ESTRUTURA CRIADA ACIMA.
"LOGO EM SEGUIDA, UMA TABELA DO TIPO DA MINHA ESTRUTURA É CRIADA, PARA QUE CADA VARIÁVEL DELA SE TORNE UMA COLUNA.
"A FINALIDADE É CONSEGUIR REGISTRAR VÁRIAS ENTRADAS DE UTILIZADORES E NÃO APENAS UMA LINHA.

DATA: LS_SEGSOC     TYPE GS_SEGSOC,                    "ESTRUTURA CRIADA A PARTIR DA ESTRUTURA ACIMA."
      LT_SEGSOC     TYPE TABLE OF GS_SEGSOC,           "TABELA INTERNA DO TIPO DA MINHA ESTRUTURA LOCAL"
      REPORTALV  TYPE REF TO CL_SALV_TABLE,            "VARIÁVEL QUE FAZ REFERÊNCIA AO OBJETO CL_SALV_TABLE."
      FUNCTIONS  TYPE REF TO CL_SALV_FUNCTIONS.        "VARIÁVEL QUE VAI ARMAZENAR A REFERÊNCIA AO OBJETO."

"CL_SALV_TABLE É UMA CLASSE DO SAP QUE PERMITE CRIAR E EXIBIR LISTAS DE RELATÓRIOS ALV.
"CL_SALV_FUNCTIONS É UMA CLASSE USADA PARA EXIBIR E CONTROLAR FUNÇÕES DISPONÍVEIS NO RELATÓRIO ALV.

"--------------------------"
"--------------------------"
"  PARÂMETROS DE ENTRADA   "
"--------------------------"
"--------------------------"

START-OF-SELECTION.

  "AQUI É ONDE O UTILIZADOR DIGITARÁ OS DADOS PEDIDOS"

  PARAMETERS:
    P_NOME TYPE C LENGTH 20, "NOME DO EMPREGADO"
    P_APOS TYPE I.           "O TEMPO DE CONTRIBUIÇÃO PARA A SEGURANÇA SOCIAL"

  SELECTION-SCREEN BEGIN OF BLOCK RADIO1 WITH FRAME TITLE TEXT-001. "DUAS OPÇÕES DE CONTRATO EM RADIOBUTTONS."
    PARAMETERS:
      PRB_CONT TYPE BOOLEAN RADIOBUTTON GROUP GRP1, "TRABALHO POR CONTRATO/EMPREGADOR"
      PRB_RECV TYPE BOOLEAN RADIOBUTTON GROUP GRP1. "TRABALHO POR RECIBO VERDE"

    "A ESCOLHA ENTRE ESTAS DUAS VAI DIFERIR EM COMO O PROGRAMA VAI SE COMPORTAR EM RELAÇÃO ÀS COBRANÇAS À SEGURANÇA SOCIAL...
    "DIREITOS, IMPOSTOS COBRADOS E VALORES A RECEBER SÃO CALCULADOS E CONCEDIDOS DE FORMA DISTINTA PARA CADA UM DOS DOIS CASOS"

  SELECTION-SCREEN END OF BLOCK RADIO1.

  PARAMETERS:
    P_SALB   TYPE P DECIMALS 2, "SALÁRIO BASE"
    P_SEGSOC TYPE P DECIMALS 2, "O QUANTO FOI CONTRIBUÍDO PARA A SEGURANÇA SOCIAL"
    P_TOTHRS TYPE I.            "TOTAL DE HORAS EXTRAS"

  SELECTION-SCREEN BEGIN OF BLOCK RADIO2 WITH FRAME TITLE TEXT-003. "QUATRO OPÇÕES DE TURNOS PARA AS HORAS EXTRAS"
    PARAMETERS:
      DAY     TYPE BOOLEAN RADIOBUTTON GROUP GRP2 DEFAULT 'X', "TURNO DO DIA"
      EVENING TYPE BOOLEAN RADIOBUTTON GROUP GRP2,             "TURNO DA TARDE"
      NIGHT   TYPE BOOLEAN RADIOBUTTON GROUP GRP2,             "TURNO DA NOITE"
      HOLYDAY TYPE BOOLEAN RADIOBUTTON GROUP GRP2.             "FINAIS DE SEMANA"

    "A ESCOLHA ENTRE OS TURNOS VAI DIFERIR EM COMO O PROGRAMA VAI SE COMPORTAR EM RELAÇÃO AO VALOR DAS HORAS EXTRAS."

  SELECTION-SCREEN END OF BLOCK RADIO2.

  SELECTION-SCREEN BEGIN OF BLOCK CHECKBOXES WITH FRAME TITLE TEXT-002. "TRÊS OPÇÕES DE BENEFÍCIOS OFERECIDOS AO EMPREGADO PELA EMPRESA"
    PARAMETERS:
      PRB_HEAL TYPE BOOLEAN AS CHECKBOX,   "PLANO PRIVADO DE SAÚDE"
      PRB_SIND TYPE BOOLEAN AS CHECKBOX,   "IMPOSTO SINDICAL"
      PRB_VALA TYPE BOOLEAN AS CHECKBOX,   "VALE REFEIÇÃO"
      PRB_VALT TYPE BOOLEAN AS CHECKBOX.   "VALE TRANSPORTE"

    "PARA CADA CHECKBOX PREENCHIDA UM VALOR REFERENTE A ESTES PRODUTOS É DEBITADO DO SALÁRIO LÍQUIDO.

  SELECTION-SCREEN END OF BLOCK CHECKBOXES.

  "--------------------------"
  "--------------------------"
  "  PARÂMETROS/ESTRUTURAS   "
  "--------------------------"
  "--------------------------"

  "ALGUNS PARÂMETROS INSERIDOS PELO UTILIZADOR NÃO PRECISAM DE TRATAMENTO, OU SEJA: DEPENDEM APENAS DO QUE O UTILIZADOR DIGITAR NOS CAMPOS."
  "DIZEMOS ENTÃO QUE ALGUMAS VARIÁVEIS DE MINHA ESTRUTURA LOCAL JÁ RECEBEM DIRETAMENTE ESTES PARÂMETROS."

  LS_SEGSOC-LV_SALBASE  = P_SALB.   "SALÁRIO BASE DA ESTRUTURA RECEBE O SALÁRIO BASE QUE O UTILIZADOR INSERIR."
  LS_SEGSOC-LV_SEGSOC   = P_SEGSOC. "SEGURANÇA SOCIAL RECEBE O VALOR DE CONTRIBUIÇÃO QUE O UTILIZADOR INSERIR"
  LS_SEGSOC-LV_NOME     = P_NOME.   "NOME DO EMPREGADO RECEBE O NOME QUE O UTILIZADOR INSERIR."

  "--------------------------"
  "--------------------------"
  "      HORAS EXTRAS        "
  "--------------------------"
  "--------------------------"

  "AQUI VAMOS CALCULAR COMO O VALOR DAS HORAS EXTRAS VAI SE COMPORTAR DE ACORDO COM O TURNO TRABALHADO"

  DATA: LV_VALHRS TYPE P DECIMALS 2. "CRIA-SE UMA VARIÁVEL QUE IRÁ RECEBER O VALOR DA HORA"

  LV_VALHRS = P_SALB / ( 8 * 22 ). "ESTE É UM CÁLCULO BÁSICO PARA SE CALCULAR QUANTO VALE A HORA EXTRA BASEADA NO SALÁRIO BASE DO EMPREGADO"
  "VALOR DA HORA = SALÁRIO BASE / ( 8 HORAS TRABALHADAS * 22 DIAS ÚTEIS DO MÊS).

  IF DAY = 'X'.                               "SE FOR DURANTE O DIA...
    P_TOTHRS = P_TOTHRS * LV_VALHRS * 2.      "AS HORAS EXTRAS VALEM O DOBRO.
  ELSEIF EVENING = 'X'.                       "SE FOR DURANTE A TARDE...
    P_TOTHRS = P_TOTHRS * LV_VALHRS * '2.5'.  "AS HORAS EXTRAS VALEM DUAS VEZES E MEIA A HORA"
  ELSEIF NIGHT = 'X'.                         "SE FOR DURANTE A NOITE...
    P_TOTHRS = P_TOTHRS * LV_VALHRS * 3.      "AS HORAS EXTRAS VALEM O TRIPLO"
  ELSEIF HOLYDAY = 'X'.                       "SE FOR DURANTE OS FERIADOS...
    P_TOTHRS = P_TOTHRS * LV_VALHRS * 4.      "AS HORAS EXTRAS VALEM O QUÁDRUPLO"
  ELSE.                                       "EM QUALQUER OUTRO CASO...
    P_TOTHRS = P_TOTHRS * LV_VALHRS * 1.      "ELAS VALEM O QUE SÃO."
  ENDIF.

  "PARA SE CALCULAR O VALOR TOTAL DAS HORAS EXTRAS A RECEBER...
  "TOTAL DE HORAS EXTRAS = TOTAL DE HORAS EXTRAS * VALOR DA HORA DO FUNCIONÁRIO * TURNO TRABALHADO."

  LS_SEGSOC-LV_HORAEXTR = P_TOTHRS.

  "DIZEMOS ENTÃO QUE O VALOR TOTAL DAS HORAS EXTRAS EM MINHA ESTRUTURA RECEBE O RESULTADO CALCULADO DO PARÂMETRO."

  LS_SEGSOC-LV_SALBRUTO = LS_SEGSOC-LV_SALBASE + LS_SEGSOC-LV_HORAEXTR.

  "APROVEITAMOS E DIZEMOS QUE O SALÁRIO BRUTO RECEBE O SALÁRIO BASE + O VALOR DAS HORAS EXTRAS."

  "--------------------------"
  "--------------------------"
  "       BENEFÍCIOS         "
  "--------------------------"
  "--------------------------"

  "DEPENDENDO DOS BENEFÍCIOS DE SERVIÇO QUE O TRABALHADOR OPTAR POR ESCOLHER, ESTES MESMOS SERÃO ACRESCENTADOS ÀS DEDUÇÕES SALARIAIS."

  IF PRB_HEAL = 'X'.                                                      "SE DECIDIR OPTAR POR UM PLANO DE SAÚDE PRIVADO...
    LS_SEGSOC-LV_PLANSAU = 'AUTORIZADO'.                                  "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
    LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( ( 5 / 100 ) * P_SALB ). "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
  ELSE.                                                                   "DO CONTRÁRIO...
    LS_SEGSOC-LV_PLANSAU = 'NÃO UTILIZADO'.                               "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
  ENDIF.

  IF PRB_SIND = 'X'.                                                      "SE DECIDIR OPTAR POR UMA CONTRIBUIÇÃO SINDICAL...
    LS_SEGSOC-LV_CONTRSIN = 'AUTORIZADO'.                                 "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
    LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + 4.                        "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
  ELSE.                                                                   "DO CONTRÁRIO...
    LS_SEGSOC-LV_CONTRSIN = 'NÃO AUTORIZADO'.                              "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
  ENDIF.

  IF PRB_VALA = 'X'.                                                      "SE DECIDIR OPTAR PELO VALE ALIMENTAÇÃO...
    LS_SEGSOC-LV_VALEREF = 'AUTORIZADO'.                                  "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
    LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + 12.                       "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS
  ELSE.                                                                   "DO CONTRÁRIO...
    LS_SEGSOC-LV_VALEREF = 'NÃO UTILIZADO'.                               "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
  ENDIF.

  IF PRB_VALT = 'X'.                                                      "SE DECIDIR OPTAR VALE TRANSPORTE...
    LS_SEGSOC-LV_VALETRS = 'AUTORIZADO'.                                  "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
    LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + 40.                       "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS
  ELSE.                                                                   "DO CONTRÁRIO...
    LS_SEGSOC-LV_VALETRS = 'NÃO UTILIZADO'.                               "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
  ENDIF.

  "DEPOIS DE TODOS OS PRODUTOS COMPRADOS OU NÃO, OS VALORES ESTARÃO SOMADOS E A VARIÁVEL LV_DEDUCT(DEDUÇÕES) RECEBERÁ ESTE VALOR.

  "--------------------------"
  "--------------------------"
  "         PENSÃO           "
  "--------------------------"
  "--------------------------"

  "CONDIÇÃO SIMPLES PARA SABER SE O EMPREGADO JÁ TEM DIREITO À PENSÃO POR IDADE.

  IF P_APOS >= 40.                     "SE O SEU TEMPO DE CONTRIBUIÇÃO FOR MAIOR DO QUE 40 ANOS"
    LS_SEGSOC-LV_PENSAO = 'APROVADO'.  "A VARIÁVEL DA ESTRUTURA RECEBE 'APROVADO'.
  ELSE.                                "SENÃO...
    LS_SEGSOC-LV_PENSAO = 'NEGADO'.    "RECEBE NEGADO ATÉ O MOMENTO.
  ENDIF.

  "--------------------------"
  "--------------------------"
  "    SEGURANÇA SOCIAL      "
  "--------------------------"
  "--------------------------"

  "CONTROLE DE FLUXO BASEADO NO SALÁRIO"
  "AS CONTRIBUIÇÕES COM A SEGURANÇA SOCIAL DIFEREM DE ACORDO COM A FAIXA SALARIAL E O TIPO DE CONTRATO...
  "SENDO ASSIM, PORCENTAGENS DIFERENTES DO SALÁRIO BASE SÃO DEBITADAS DE ACORDO COM ESTES CRITÉRIOS.
  "ALÉM DISSO, OS VALORES ACRESCIDOS À VARIÁVEL DE DEDUÇÃO DEPENDEM DA QUANTIDADE DO VALOR CONTRIBUÍDO.

  "[CONTRATO]"

  IF P_SALB <= 760.                                                                    "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO...
    IF PRB_CONT = 'X'.                                                                 "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO...
      LS_SEGSOC-LV_TIPOCONTR = 'CONTRATO'.                                             "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE CONTRATO."
      IF P_SEGSOC < ( 50 / 100 ) * P_SALB.                                             "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO E CONTRIBUIU COM MENOS DE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                                "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                               "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 12 ).                 "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ELSE.                                                                            "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        IF P_SEGSOC => ( 50 / 100 ) * P_SALB AND P_SEGSOC < ( 60 / 100 ) * P_SALB.     "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 50% E MENOR QUE 60%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                            "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
          LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                             "TENDO DURAÇÃO DE 6 MESES.
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 12 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSEIF P_SEGSOC => ( 60 / 100 ) * P_SALB AND P_SEGSOC < ( 70 / 100 ) * P_SALB. "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 60% E MENOR QUE 70%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.5'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.5."
          LS_SEGSOC-LV_TEMSUB = '8 MESES'.                                             "TENDO DURAÇÃO DE 8 MESES."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 12 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSE.                                                                          "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50%, 60% E 70%"
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.2'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.2."
          LS_SEGSOC-LV_TEMSUB = '1 ANO'.                                               "TENDO DURAÇÃO DE 1 ANO."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 12 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.

  "[RECIBO VERDE]"

  IF P_SALB <= 760.
    IF PRB_RECV = 'X'.                                                   "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE...
      LS_SEGSOC-LV_TIPOCONTR = 'RECIBO VERDE'.                           "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE RECIBO VERDE."
      IF P_SEGSOC < ( ( 73 / 100 ) * P_SALB ).                           "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE E CONTRIBUIU COM MENOS DE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...


        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                  "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                 "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 12 ).   "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS."
      ELSE.                                                              "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                 "TENDO DURAÇÃO DE 6 MESES.
        LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 12 ).   "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ENDIF.
    ENDIF.
  ENDIF.

  "[CONTRATO]"

  IF P_SALB > 760 AND P_SALB =< 1500.                                                  "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO...
    IF PRB_CONT = 'X'.                                                                 "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO...
      LS_SEGSOC-LV_TIPOCONTR = 'CONTRATO'.                                             "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE CONTRATO."
      IF P_SEGSOC < ( 50 / 100 ) * P_SALB.                                             "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO E CONTRIBUIU COM MENOS DE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                                "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                               "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 11 ).                 "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ELSE.                                                                            "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        IF P_SEGSOC => ( 50 / 100 ) * P_SALB AND P_SEGSOC < ( 60 / 100 ) * P_SALB.     "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 50% E MENOR QUE 60%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                            "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
          LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                             "TENDO DURAÇÃO DE 6 MESES.
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 11 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSEIF P_SEGSOC => ( 60 / 100 ) * P_SALB AND P_SEGSOC < ( 70 / 100 ) * P_SALB. "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 60% E MENOR QUE 70%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.5'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.5."
          LS_SEGSOC-LV_TEMSUB = '8 MESES'.                                             "TENDO DURAÇÃO DE 8 MESES."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 11 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSE.                                                                          "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50%, 60% E 70%"
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.2'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.2."
          LS_SEGSOC-LV_TEMSUB = '1 ANO'.                                               "TENDO DURAÇÃO DE 1 ANO."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 11 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.

  "[RECIBO VERDE]"

  IF P_SALB > 760 AND P_SALB =< 1500.
    IF PRB_RECV = 'X'.                                                   "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE...
      LS_SEGSOC-LV_TIPOCONTR = 'RECIBO VERDE'.                           "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE RECIBO VERDE."
      IF P_SEGSOC < ( ( 73 / 100 ) * P_SALB ).                           "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE E CONTRIBUIU COM MENOS DE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...


        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                  "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                 "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 11 ).   "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS."
      ELSE.                                                              "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                 "TENDO DURAÇÃO DE 6 MESES.
        LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 11 ).   "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ENDIF.
    ENDIF.
  ENDIF.

  "[CONTRATO]"

  IF P_SALB > 1500 AND P_SALB =< 3000.                                                 "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO...
    IF PRB_CONT = 'X'.                                                                 "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO...
      LS_SEGSOC-LV_TIPOCONTR = 'CONTRATO'.                                             "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE CONTRATO."
      IF P_SEGSOC < ( 50 / 100 ) * P_SALB.                                             "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO E CONTRIBUIU COM MENOS DE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                                "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                               "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 10 ).                 "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ELSE.                                                                            "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        IF P_SEGSOC => ( 50 / 100 ) * P_SALB AND P_SEGSOC < ( 60 / 100 ) * P_SALB.     "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 50% E MENOR QUE 60%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                            "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
          LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                             "TENDO DURAÇÃO DE 6 MESES.
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 10 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSEIF P_SEGSOC => ( 60 / 100 ) * P_SALB AND P_SEGSOC < ( 70 / 100 ) * P_SALB. "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 60% E MENOR QUE 70%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.5'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.5."
          LS_SEGSOC-LV_TEMSUB = '8 MESES'.                                             "TENDO DURAÇÃO DE 8 MESES."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 10 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSE.                                                                          "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50%, 60% E 70%"
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.2'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.2."
          LS_SEGSOC-LV_TEMSUB = '1 ANO'.                                               "TENDO DURAÇÃO DE 1 ANO."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 10 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.

  "[RECIBO VERDE]"

  IF P_SALB > 1500 AND P_SALB =< 3000.
    IF PRB_RECV = 'X'.                                                   "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE...
      LS_SEGSOC-LV_TIPOCONTR = 'RECIBO VERDE'.                           "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE RECIBO VERDE."
      IF P_SEGSOC < ( ( 73 / 100 ) * P_SALB ).                           "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE E CONTRIBUIU COM MENOS DE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...


        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                  "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                 "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 10 ).   "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS."
      ELSE.                                                              "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                 "TENDO DURAÇÃO DE 6 MESES.
        LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 10 ).   "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ENDIF.
    ENDIF.
  ENDIF.

  "[CONTRATO]"

  IF P_SALB > 3000 AND P_SALB =< 5000.                                                 "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO...
    IF PRB_CONT = 'X'.                                                                 "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO...
      LS_SEGSOC-LV_TIPOCONTR = 'CONTRATO'.                                             "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE CONTRATO."
      IF P_SEGSOC < ( 50 / 100 ) * P_SALB.                                             "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO E CONTRIBUIU COM MENOS DE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                                "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                               "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 9 ).                  "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ELSE.                                                                            "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        IF P_SEGSOC => ( 50 / 100 ) * P_SALB AND P_SEGSOC < ( 60 / 100 ) * P_SALB.     "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 50% E MENOR QUE 60%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                            "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
          LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                             "TENDO DURAÇÃO DE 6 MESES.
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 10 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSEIF P_SEGSOC => ( 60 / 100 ) * P_SALB AND P_SEGSOC < ( 70 / 9 ) * P_SALB.   "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 60% E MENOR QUE 70%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.5'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.5."
          LS_SEGSOC-LV_TEMSUB = '8 MESES'.                                             "TENDO DURAÇÃO DE 8 MESES."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 9 ).                "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSE.                                                                          "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50%, 60% E 70%"
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.2'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.2."
          LS_SEGSOC-LV_TEMSUB = '1 ANO'.                                               "TENDO DURAÇÃO DE 1 ANO."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 9 ).                "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.

  "[RECIBO VERDE]"

  IF P_SALB > 3000 AND P_SALB =< 5000.
    IF PRB_RECV = 'X'.                                                   "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE...
      LS_SEGSOC-LV_TIPOCONTR = 'RECIBO VERDE'.                           "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE RECIBO VERDE."
      IF P_SEGSOC < ( ( 73 / 100 ) * P_SALB ).                           "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE E CONTRIBUIU COM MENOS DE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...


        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                  "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                 "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 9 ).    "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS."
      ELSE.                                                              "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                 "TENDO DURAÇÃO DE 6 MESES.
        LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 9 ).    "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ENDIF.
    ENDIF.
  ENDIF.

  "[CONTRATO]"

  IF P_SALB > 5000 AND P_SALB =< 10000.                                                "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO...
    IF PRB_CONT = 'X'.                                                                 "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO...
      LS_SEGSOC-LV_TIPOCONTR = 'CONTRATO'.                                             "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE CONTRATO."
      IF P_SEGSOC < ( 50 / 100 ) * P_SALB.                                             "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE CONTRATO E CONTRIBUIU COM MENOS DE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                                "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                               "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 8 ).                  "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ELSE.                                                                            "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        IF P_SEGSOC => ( 50 / 100 ) * P_SALB AND P_SEGSOC < ( 60 / 100 ) * P_SALB.     "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 50% E MENOR QUE 60%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                            "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
          LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                             "TENDO DURAÇÃO DE 6 MESES.
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 10 ).               "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSEIF P_SEGSOC => ( 60 / 100 ) * P_SALB AND P_SEGSOC < ( 70 / 8 ) * P_SALB.   "SENDO ESSA CONTRIBUIÇÃO MAIOR QUE 60% E MENOR QUE 70%...
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.5'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.5."
          LS_SEGSOC-LV_TEMSUB = '8 MESES'.                                             "TENDO DURAÇÃO DE 8 MESES."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 8 ).                "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ELSE.                                                                          "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 50%, 60% E 70%"
          LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                            "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
          LS_SEGSOC-LV_VALSUB = P_SALB / '1.2'.                                        "O VALOR QUE ELE RECEBE SERÁ = SALÁRIO BASE / 1.2."
          LS_SEGSOC-LV_TEMSUB = '1 ANO'.                                               "TENDO DURAÇÃO DE 1 ANO."
          LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 8 ).                "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
        ENDIF.
      ENDIF.
    ENDIF.
  ENDIF.

  "[RECIBO VERDE]"

  IF P_SALB > 5000 AND P_SALB =< 10000.
    IF PRB_RECV = 'X'.                                                   "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE...
      LS_SEGSOC-LV_TIPOCONTR = 'RECIBO VERDE'.                           "ENTÃO CONSTA NO SISTEMA QUE ELE ESTÁ EM REGIME DE RECIBO VERDE."
      IF P_SEGSOC < ( ( 73 / 100 ) * P_SALB ).                           "SE O EMPREGADO RECEBE UM SALÁRIO MÍNIMO E SE TRABALHA EM REGIME DE RECIBO VERDE E CONTRIBUIU COM MENOS DE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...


        LS_SEGSOC-LV_SUBDES = 'NEGADO'.                                  "ENTÃO NÃO TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '0 MESES'.                                 "NÃO TENDO DIREITO AO SUBSÍDIO CONSTA QUE A DURAÇÃO DO SUBSÍDIO RECEBE 0 MESES."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 8 ).    "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS."
      ELSE.                                                              "DO CONTRÁRIO...CASO ELE TENHA CONTRIBUÍDO COM MAIS QUE 73% DO SEU ORDENADO À SEGURANÇA SOCIAL...
        LS_SEGSOC-LV_SUBDES = 'APROVADO'.                                "ENTÃO ELE TEM DIREITO AO SUBSÍDIO DESEMPREGO."
        LS_SEGSOC-LV_TEMSUB = '6 MESES'.                                 "TENDO DURAÇÃO DE 6 MESES.
        LS_SEGSOC-LV_VALSUB = P_SALB / 2.                                "O VALOR QUE ELE RECEBE SERÁ = A METADE DO SALÁRIO BASE."
        LS_SEGSOC-LV_DEDUCT = LS_SEGSOC-LV_DEDUCT + ( P_SEGSOC / 8 ).    "O VALOR DA CONTRIBUIÇÃO ADICIONADO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
      ENDIF.
    ENDIF.
  ENDIF.

  "PS = ISTO PODERIA SER FEITO TODO DENTRO DE APENAS UM IF, PORÉM...ACHEI MELHOR SEPARAR AS CONDIÇÕES PARA UM MELHOR ENTENDIMENTO DO CÓDIGO."

  "POR FIM, JÁ TEMOS TODOS OS VALORES E AS LÓGICAS POR DETRÁS DELES...MENOS UM.
  "NOSSO SALÁRIO LÍQUIDO, QUE É NOSSO SALÁRIO BRUTO MENOS TODAS AS DEDUÇÕES TRIBUTÁRIAS...
  "AS DEDUÇÕES TRIBUTÁRIAS SÓ PODERIAM SER CALCULADAS EM TOTALIDADE APÓS SABER QUANTO CADA EMPREGADOR TERÁ DE DECLARAR PARA A SEGURANÇA SOCIAL E QUANTIFICAR OS SERVIÇOS QUE O EMPREGADOR ADERIU."
  "SENDO ASSIM, PODEMOS ADMITIR QUE:"

  LS_SEGSOC-LV_SALIQ = LS_SEGSOC-LV_SALBRUTO - LS_SEGSOC-LV_DEDUCT. "SALÁRIO LÍQUIDO É O SALÁRIO BRUTO MENOS AS DEDUÇÕES SALARIAIS(CARGAS TRIBUTÁRIAS E SERVIÇOS).

  "----------------------------"
  "----------------------------"
  "TRATAMENTO DE TABELA INTERNA"
  "----------------------------"
  "----------------------------"

APPEND LS_SEGSOC TO LT_SEGSOC. "APÓS TODAS AS VARIÁVEIS DE NOSSA ESTRUTURA LOCAL ESTAREM PREENCHIDAS, SIMPLESMENTE INSERIMOS ELA COMO UMA LINHA DENTRO DE NOSSA TABELA INTERNA.

  TRY.                                                                   "MANIPULAÇÃO E TRATAMENTO DE ERROS"
        CALL METHOD CL_SALV_TABLE=>FACTORY                               "O MÉTODO DA CLASSE FACTORY FOI CHAMADO PARA EXIBIR O RELATÓRIO ALV."
          IMPORTING                                                      "MINHA TABELA INTERNA FOI INTRODUZIDA PARA ESTE PROCESSO."
            R_SALV_TABLE = REPORTALV                                     
          CHANGING
            T_TABLE      = LT_SEGSOC.

        FUNCTIONS = REPORTALV->GET_FUNCTIONS( ).
        FUNCTIONS->SET_ALL( ABAP_TRUE ).

        CALL METHOD REPORTALV->DISPLAY( ).
      CATCH CX_SALV_MSG.
        MESSAGE 'Error to display ALV Report' TYPE 'S' DISPLAY LIKE 'I'.
    ENDTRY.
