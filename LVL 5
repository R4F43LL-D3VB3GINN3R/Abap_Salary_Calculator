REPORT ZESTUDOS1.

"PRIMEIRAMENTE CRIAMOS UMA ESTRUTURA QUE SERVIRÁ DE REFERÊNCIA PARA A MINHA ESTRUTURA LOCAL.
"NELA, MINHAS VARIÁVEIS SÃO ADICIONADAS OU REMOVIDAS DE ACORDO COM AS NECESSIDADES QUE VÃO SURGINDO NO DECORRER DA CONSTRUÇÃO DO PROGRAMA.

TYPES:BEGIN OF WA_EMP,                  "ESTRUTURA GLOBAL"
        LV_NOME      TYPE C LENGTH  20, "NOME DO FUNCIONÁRIO"
        LV_NIF       TYPE C LENGTH   9, "BIF DO FUNCIONÁRIO"
        LV_TURNO     TYPE C LENGTH  10, "TURNO DE TRABALHO.
        LV_TIPOCONTR TYPE C LENGTH  20, "TIPO DE CONTRATO = CONTRATO OU RECIBO VERDE"
        LV_SALBASE   TYPE P DECIMALS 2, "SALÁRIO BASE"
        LV_SALBRUTO  TYPE P DECIMALS 2, "SALÁRIO BRUTO"
        LV_SALIQ     TYPE P DECIMALS 2, "SALÁRIO LÍQUIDO"
        LV_PLANSAU   TYPE C LENGTH  15, "PLANO PRIVADO DE SAÚDE"
        LV_CONTRSIN  TYPE C LENGTH  15, "CONTRIBUIÇÃO SINDICAL"
        LV_VALEREF   TYPE C LENGTH  15, "VALE REFEIÇÃO"
        LV_VALETRS   TYPE C LENGTH  15, "VALE TRANSPORTE"
        LV_HORAEXTR  TYPE P DECIMALS 2, "HORAS EXTRAS"
        LV_DEDUCT    TYPE P DECIMALS 2, "TOTAL DE DEDUÇÕES"
        LV_SEGSOC    TYPE P DECIMALS 2, "SEGURANÇA SOCIAL"
        LV_IRS       TYPE P DECIMALS 2, "IMPOSTO IRS"
        LV_BONUS     TYPE P DECIMALS 2, "BÔNUS SALARIAL"
        LV_SUBDP     TYPE P DECIMALS 2, "SUBTRAÇÃO DE PRESENÇAS"
      END OF WA_EMP.

"A PARTIR DO QUE TEMOS ACIMA, FOI CRIADA ENTÃO UMA ESTRUTURA LOCAL QUE TEM COMO ESCOPO A ESTRUTURA CRIADA ACIMA.
"LOGO EM SEGUIDA, UMA TABELA DO TIPO DA MINHA ESTRUTURA É CRIADA, PARA QUE CADA VARIÁVEL DELA SE TORNE UMA COLUNA.
"A FINALIDADE É CONSEGUIR REGISTRAR VÁRIAS ENTRADAS DE UTILIZADORES E NÃO APENAS UMA LINHA.

DATA: LS_SAL TYPE WA_EMP,                             "ESTRUTURA CRIADA A PARTIR DA ESTRUTURA ACIMA."
      LT_SAL TYPE TABLE OF WA_EMP,                    "TABELA INTERNA DO TIPO DA MINHA ESTRUTURA LOCAL"
      REPORTALV TYPE REF TO CL_SALV_TABLE,            "VARIÁVEL QUE FAZ REFERÊNCIA AO OBJETO DA CLASSE CL_SALV_TABLE."
      FUNCTIONS TYPE REF TO CL_SALV_FUNCTIONS.        "VARIÁVEL QUE VAI ARMAZENAR A REFERÊNCIA AO OBJETO DA CLASSE CL_SALV_FUNCTIONS."

"CL_SALV_TABLE É UMA CLASSE DO SAP QUE PERMITE CRIAR E EXIBIR LISTAS DE RELATÓRIOS ALV.
"CL_SALV_FUNCTIONS É UMA CLASSE USADA PARA EXIBIR E CONTROLAR FUNÇÕES DISPONÍVEIS NO RELATÓRIO ALV.

"--------------------------"
"--------------------------"
"  PARÂMETROS DE ENTRADA   "
"--------------------------"
"--------------------------"

START-OF-SELECTION.

  "AQUI É ONDE O UTILIZADOR DIGITARÁ OS DADOS PEDIDOS"

  PARAMETERS:
    P_NOME TYPE C LENGTH 20,  "NOME DO EMPREGADO"
    P_NIF  TYPE C LENGTH 9.   "NIF DO FUNCIONÁRIO"

  LS_SAL-LV_NOME = P_NOME.
  LS_SAL-LV_NIF  = P_NIF.

  SELECTION-SCREEN BEGIN OF BLOCK RADIO3 WITH FRAME TITLE TEXT-006. "DUAS OPÇÕES DE CONTRATO EM RADIOBUTTONS."
    PARAMETERS:
      PRB_DIAA  TYPE BOOLEAN RADIOBUTTON GROUP GRP4, "TURNO DO DIA"
      PRB_NOIT  TYPE BOOLEAN RADIOBUTTON GROUP GRP4. "TURNO DA NOITE"

    "A ESCOLHA ENTRE ESTAS DUAS VAI DIFERIR EM COMO O PROGRAMA VAI SE COMPORTAR EM RELAÇÃO ÀS COBRANÇAS À SEGURANÇA SOCIAL...
    "DIREITOS, IMPOSTOS COBRADOS E VALORES A RECEBER SÃO CALCULADOS E CONCEDIDOS DE FORMA DISTINTA PARA CADA UM DOS DOIS CASOS"

  SELECTION-SCREEN END OF BLOCK RADIO3.

  SELECTION-SCREEN BEGIN OF BLOCK RADIO1 WITH FRAME TITLE TEXT-001. "DUAS OPÇÕES DE CONTRATO EM RADIOBUTTONS."
    PARAMETERS:
      PRB_CONT TYPE BOOLEAN RADIOBUTTON GROUP GRP1, "TRABALHO POR CONTRATO/EMPREGADOR"
      PRB_RECV TYPE BOOLEAN RADIOBUTTON GROUP GRP1. "TRABALHO POR RECIBO VERDE"

    "A ESCOLHA ENTRE ESTAS DUAS VAI DIFERIR EM COMO O PROGRAMA VAI SE COMPORTAR EM RELAÇÃO ÀS COBRANÇAS À SEGURANÇA SOCIAL...
    "DIREITOS, IMPOSTOS COBRADOS E VALORES A RECEBER SÃO CALCULADOS E CONCEDIDOS DE FORMA DISTINTA PARA CADA UM DOS DOIS CASOS"

  SELECTION-SCREEN END OF BLOCK RADIO1.

  PARAMETERS:
    P_SALB   TYPE P DECIMALS 2, "SALÁRIO BASE"
    P_TOTHRS TYPE I.            "TOTAL DE HORAS EXTRAS"

  LS_SAL-LV_SALBASE = P_SALB.

  SELECTION-SCREEN BEGIN OF BLOCK RADIO2 WITH FRAME TITLE TEXT-003. "QUATRO OPÇÕES DE TURNOS PARA AS HORAS EXTRAS"
    PARAMETERS:

      ZERO    TYPE BOOLEAN RADIOBUTTON GROUP GRP2 DEFAULT 'X', "SEM HORAS EXTRAS"
      DAY     TYPE BOOLEAN RADIOBUTTON GROUP GRP2,             "TURNO DO DIA"
      NIGHT   TYPE BOOLEAN RADIOBUTTON GROUP GRP2.             "TURNO DA NOITE"


    "A ESCOLHA ENTRE OS TURNOS VAI DIFERIR EM COMO O PROGRAMA VAI SE COMPORTAR EM RELAÇÃO AO VALOR DAS HORAS EXTRAS."

  SELECTION-SCREEN END OF BLOCK RADIO2.

  SELECTION-SCREEN BEGIN OF BLOCK CHECKBOXES WITH FRAME TITLE TEXT-002. "TRÊS OPÇÕES DE BENEFÍCIOS OFERECIDOS AO EMPREGADO PELA EMPRESA"
    PARAMETERS:
      PRB_HEAL TYPE BOOLEAN AS CHECKBOX, "PLANO PRIVADO DE SAÚDE"
      PRB_SIND TYPE BOOLEAN AS CHECKBOX, "IMPOSTO SINDICAL"
      PRB_VALA TYPE BOOLEAN AS CHECKBOX, "VALE REFEIÇÃO"
      PRB_VALT TYPE BOOLEAN AS CHECKBOX. "VALE TRANSPORTE"

    "PARA CADA CHECKBOX PREENCHIDA UM VALOR REFERENTE A ESTES PRODUTOS É DEBITADO DO SALÁRIO LÍQUIDO.

  SELECTION-SCREEN END OF BLOCK CHECKBOXES.

  SELECTION-SCREEN BEGIN OF BLOCK CHECKBOXES4 WITH FRAME TITLE TEXT-004. "QUATRO OPÇÕES DE TURNOS PARA AS HORAS EXTRAS"
    PARAMETERS:
      CKB_MET1 TYPE BOOLEAN AS CHECKBOX, "META DE NÍVEL 1"
      CKB_MET2 TYPE BOOLEAN AS CHECKBOX, "META DE NÍVEL 2"
      CKB_MET3 TYPE BOOLEAN AS CHECKBOX. "META DE NÍVEL 3"

   "DEPENDENDO DA ESCOLHA DE META, UM VALOR SERÁ ACRESCIDO AO SALÁRIO LÍQUIDO DO FUNCIONÁRIO.

   SELECTION-SCREEN END OF BLOCK CHECKBOXES4.

   SELECTION-SCREEN BEGIN OF BLOCK CHECKBOXES3 WITH FRAME TITLE TEXT-005. "OBSERVAÇÕES SOBRE A CONDUTA MENSAL DO FUNCIONÁRIO"
    PARAMETERS:
      CKB_FALT TYPE BOOLEAN AS CHECKBOX, "FALTA AO TRABALHO"
      P_NUMF   TYPE I,                   "NÚMERO DE DIAS QUE FALTOU"
      CKB_DOEN TYPE BOOLEAN AS CHECKBOX, "FALTA POR MOTIVO DE DOENÇA"
      P_NUMD   TYPE I,                   "NÚMERO DE DIAS QUE FALTOU"
      CKB_ATRA TYPE BOOLEAN AS CHECKBOX, "ATRASO AOS HORÁRIOS"
      P_NUMATR TYPE I.                   "QUANTAS HORAS DE ATRASO AO TRABALHO"

    "QUALQUER VALOR PREENCHIDO NA CHECKBOX FAZ COM QUE UM VALOR SEJA SUBTRAÍDO DO SALÁRIO LÍQUIDO.

  SELECTION-SCREEN END OF BLOCK CHECKBOXES3.

"--------------------------"
"--------------------------"
"     BÔNUS DE METAS       "
"--------------------------"
"--------------------------"

"A CADA NÍVEL DE META BATIDO, UM VALOR EM % É ACRESCIDO AO BÔNUS DO FUNCIONÁRIO"
"POSTERIORMENTE, ESTE BÔNUS SERÁ SOMADO AO SALÁRIO LÍQUIDO"

IF CKB_MET1 = 'X'.                                            "SE O FUNCIONÁRIO ATINGE O PRIMEIRO NÍVEL DE META"
  LS_SAL-LV_BONUS = LS_SAL-LV_BONUS + ( '0.10' * P_SALB ).    "ELE RECEBE 10% DO SALÁRIO BASE"
ELSEIF CKB_MET2 = 'X'.                                        "SE O FUNCIONÁRIO ATINGE O SEGUNDO NÍVEL DE META"
  LS_SAL-LV_BONUS = LS_SAL-LV_BONUS + ( '0.25' * P_SALB ).    "ELE RECEBE 25% DO SALÁRIO BASE"
ELSEIF CKB_MET3 = 'X'.                                        "SE O FUNCIONÁRIO ATINGE O TERCEIRO NÍVEL DE META"
  LS_SAL-LV_BONUS = LS_SAL-LV_BONUS + ( '0.50' * P_SALB ).    "ELE RECEBE 50% DO SALÁRIO BASE"
ELSE.                                                         "DO CONTRÁRIO
  LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT  + ( '0.10' * P_SALB ). "O FUNCIONÁRIO É PENALIZADO COM UMA MULTA DE 10% NO SALÁRIO BASE".
ENDIF.

"--------------------------"
"--------------------------"
"       BENEFÍCIOS         "
"--------------------------"
"--------------------------"

  "DEPENDENDO DOS BENEFÍCIOS DE SERVIÇO QUE O TRABALHADOR OPTAR POR ESCOLHER, ESTES MESMOS SERÃO ACRESCENTADOS ÀS DEDUÇÕES SALARIAIS."

  IF PRB_HEAL = 'X'.                                                      "SE DECIDIR OPTAR POR UM PLANO DE SAÚDE PRIVADO...
    LS_SAL-LV_PLANSAU = 'AUTORIZADO'.                                     "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( ( 5 / 100 ) * P_SALB ).       "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
  ELSE.                                                                   "DO CONTRÁRIO...
    LS_SAL-LV_PLANSAU = 'NÃO UTILIZADO'.                                  "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
  ENDIF.

  IF PRB_SIND = 'X'.                                                      "SE DECIDIR OPTAR POR UMA CONTRIBUIÇÃO SINDICAL...
    LS_SAL-LV_CONTRSIN = 'AUTORIZADO'.                                    "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + 4.                              "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS.
  ELSE.                                                                   "DO CONTRÁRIO...
    LS_SAL-LV_CONTRSIN = 'NÃO AUTORIZADO'.                                "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
  ENDIF.

  IF PRB_VALA = 'X'.                                                      "SE DECIDIR OPTAR PELO VALE ALIMENTAÇÃO...
    LS_SAL-LV_VALEREF = 'AUTORIZADO'.                                     "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
    LS_SAL-LV_BONUS = LS_SAL-LV_BONUS + '103.5'.                             "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS
  ELSE.                                                                   "DO CONTRÁRIO...
    LS_SAL-LV_VALEREF = 'NÃO UTILIZADO'.                                  "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
  ENDIF.

  IF PRB_VALT = 'X'.                                                      "SE DECIDIR OPTAR VALE TRANSPORTE...
    LS_SAL-LV_VALETRS = 'AUTORIZADO'.                                     "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR AUTORIZADO"
    LS_SAL-LV_BONUS = LS_SAL-LV_BONUS + '103.5'.                         "O PREÇO DO PRODUTO É ACRESCIDO À VARIÁVEL DE DEDUÇÕES SALARIAIS
  ELSE.                                                                   "DO CONTRÁRIO...
    LS_SAL-LV_VALETRS = 'NÃO UTILIZADO'.                                  "A VARIÁVEL DA ESTRUTURA RECEBE O VALOR NÃO AUTORIZADO"
  ENDIF.

  "DEPOIS DE TODOS OS PRODUTOS COMPRADOS OU NÃO, OS VALORES ESTARÃO SOMADOS E A VARIÁVEL LV_DEDUCT(DEDUÇÕES) RECEBERÁ ESTE VALOR.

"--------------------------"
"--------------------------"
"    TURNO DE TRABALHO     "
"--------------------------"
"--------------------------"

"VAMOS CUIDAR PARA QUE O TRABALHADOR NOTURNO RECEBA O SEU ADICIONAL POR DIREITO"
"E QUE SEJA INFORMADO TAMBÉM EM QUAL TURNO ELE TRABALHA."

IF PRB_NOIT = 'X'.                                         "SE O TURNO DO EMPREGADO FOR DURANTE A NOITE"
  LS_SAL-LV_TURNO = 'NOTURNO'.
  LS_SAL-LV_BONUS = LS_SAL-LV_BONUS + ( '0.25' * P_SALB ). "ELE RECEBERÁ UM BÔNUS DE 25% DO SEU SALÁRIO BASE"
ELSE.
  LS_SAL-LV_TURNO = 'DIURNO'.
ENDIF.

"--------------------------"
"--------------------------"
"    TIPO DE CONTRATO      "
"--------------------------"
"--------------------------"

IF PRB_CONT = 'X'.
  LS_SAL-LV_TIPOCONTR = 'CONTRATO'.
ELSE.
  LS_SAL-LV_TIPOCONTR = 'RECIBO VERDE'.
ENDIF.

"--------------------------"
"--------------------------"
"      HORAS EXTRAS        "
"--------------------------"
"--------------------------"

  "AQUI VAMOS CALCULAR COMO O VALOR DAS HORAS EXTRAS VAI SE COMPORTAR DE ACORDO COM O TURNO TRABALHADO"

  DATA: LV_VALHRS TYPE P DECIMALS 2. "CRIA-SE UMA VARIÁVEL QUE IRÁ RECEBER O VALOR DA HORA"

  LV_VALHRS = P_SALB / ( 8 * 22 ). "ESTE É UM CÁLCULO BÁSICO PARA SE CALCULAR QUANTO VALE A HORA EXTRA BASEADA NO SALÁRIO BASE DO EMPREGADO"
  "VALOR DA HORA = SALÁRIO BASE / ( 8 HORAS TRABALHADAS * 22 DIAS ÚTEIS DO MÊS).

  IF DAY = 'X'.                               "SE FOR DURANTE O DIA...
    P_TOTHRS = P_TOTHRS * LV_VALHRS * 2.      "AS HORAS EXTRAS VALEM O DOBRO.
  ELSEIF NIGHT = 'X'.                         "SE FOR DURANTE A NOITE...
    P_TOTHRS = P_TOTHRS * LV_VALHRS * 3.      "AS HORAS EXTRAS VALEM O TRIPLO"
  ELSE.                                       "EM QUALQUER OUTRO CASO...
    P_TOTHRS = P_TOTHRS * LV_VALHRS * 1.      "ELAS VALEM O QUE SÃO."
  ENDIF.

  "PARA SE CALCULAR O VALOR TOTAL DAS HORAS EXTRAS A RECEBER...
  "TOTAL DE HORAS EXTRAS = TOTAL DE HORAS EXTRAS * VALOR DA HORA DO FUNCIONÁRIO * TURNO TRABALHADO."

  LS_SAL-LV_HORAEXTR = P_TOTHRS.

  "DIZEMOS ENTÃO QUE O VALOR TOTAL DAS HORAS EXTRAS EM MINHA ESTRUTURA RECEBE O RESULTADO CALCULADO DO PARÂMETRO."

  LS_SAL-LV_SALBRUTO = LS_SAL-LV_SALBASE + LS_SAL-LV_HORAEXTR.

  "APROVEITAMOS E DIZEMOS QUE O SALÁRIO BRUTO RECEBE O SALÁRIO BASE + O VALOR DAS HORAS EXTRAS."

  "--------------------------"
  "--------------------------"
  "    SEGURANÇA SOCIAL      "
  "--------------------------"
  "--------------------------"

  "CONTROLE DE FLUXO BASEADO NO SALÁRIO"
  "AS CONTRIBUIÇÕES COM A SEGURANÇA SOCIAL DIFEREM DE ACORDO COM A FAIXA SALARIAL E O TIPO DE CONTRATO...
  "SENDO ASSIM, PORCENTAGENS DIFERENTES DO SALÁRIO BASE SÃO DEBITADAS DE ACORDO COM ESTES CRITÉRIOS.
  "ALÉM DISSO, OS VALORES ACRESCIDOS À VARIÁVEL DE DEDUÇÃO DEPENDEM DA QUANTIDADE DO VALOR CONTRIBUÍDO.

  "[CONTRATO]"

  DATA: LV_SEGSOC TYPE P DECIMALS 2.
  DATA: LV_IRS    TYPE P DECIMALS 2.

  IF P_SALB < 886 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
  ELSEIF P_SALB => 886 AND P_SALB < 932 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.06' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.06' * P_SALB ).
  ELSEIF P_SALB => 932 AND P_SALB < 999 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.08' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.08' * P_SALB ).
  ELSEIF P_SALB => 999 AND P_SALB < 1106 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.09' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.09' * P_SALB ).
  ELSEIF P_SALB => 1106 AND P_SALB < 1600 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.11' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.11' * P_SALB ).
  ELSEIF P_SALB => 1600 AND P_SALB < 1961 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.16' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.16' * P_SALB ).
  ELSEIF P_SALB => 1961 AND P_SALB < 2529 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.19' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.19' * P_SALB ).
  ELSEIF P_SALB => 2529 AND P_SALB < 3694 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.23' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.23' * P_SALB ).
  ELSEIF P_SALB => 3694 AND P_SALB < 5469 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.28' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.28' * P_SALB ).
  ELSEIF P_SALB => 5469 AND P_SALB < 6420 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.32' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.32' * P_SALB ).
  ELSEIF P_SALB => 6420 AND P_SALB < 20064 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.33' * P_SALB ).
    LV_SEGSOC = '0.11' * P_SALB.
    LV_IRS = ( '0.33' * P_SALB ).
  ELSEIF P_SALB => 20064 AND PRB_CONT = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.11' * P_SALB ) + ( '0.41' * P_SALB ).
    LV_SEGSOC = '0.011' * P_SALB.
    LV_IRS = ( '0.41' * P_SALB ).
    ENDIF.

  "[RECIBO VERDE]"

  IF P_SALB < 886 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
  ELSEIF P_SALB => 886 AND P_SALB < 932 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.06' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.06' * P_SALB ).
  ELSEIF P_SALB => 932 AND P_SALB < 999 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.08' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.08' * P_SALB ).
  ELSEIF P_SALB => 999 AND P_SALB < 1106 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.09' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.09' * P_SALB ).
  ELSEIF P_SALB => 1106 AND P_SALB < 1600 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.11' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.11' * P_SALB ).
  ELSEIF P_SALB => 1600 AND P_SALB < 1961 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.16' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.16' * P_SALB ).
  ELSEIF P_SALB => 1961 AND P_SALB < 2529 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.19' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.19' * P_SALB ).
  ELSEIF P_SALB => 2529 AND P_SALB < 3694 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.23' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.23' * P_SALB ).
  ELSEIF P_SALB => 3694 AND P_SALB < 5469 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.28' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.28' * P_SALB ).
  ELSEIF P_SALB => 5469 AND P_SALB < 6420 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.32' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.32' * P_SALB ).
  ELSEIF P_SALB => 6420 AND P_SALB < 20064 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.33' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.33' * P_SALB ).
  ELSEIF P_SALB => 20064 AND PRB_RECV = 'X'.
    LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + ( '0.23' * P_SALB ) + ( '0.41' * P_SALB ).
    LV_SEGSOC = '0.23' * P_SALB.
    LV_IRS = ( '0.41' * P_SALB ).
    ENDIF.

    LS_SAL-LV_SEGSOC = LV_SEGSOC.
    LS_SAL-LV_IRS    = LV_IRS.

  "--------------------------"
  "--------------------------"
  "        DESEMPENHO        "
  "--------------------------"
  "--------------------------"

  IF CKB_FALT = 'X'.
    P_NUMF = P_NUMF * ( P_SALB / 22 ).
  ELSE.
    P_NUMF = 0.
  ENDIF.

  IF CKB_DOEN = 'X'.
    P_NUMD = P_NUMD * ( P_SALB / 22 ).
  ELSE.
    P_NUMD = 0.
  ENDIF.

  IF CKB_ATRA = 'X'.
    P_NUMATR = P_NUMATR * ( P_SALB / 176 ).
  ELSE.
    P_NUMATR = 0.
  ENDIF.

  LS_SAL-LV_SUBDP = P_NUMF + P_NUMD + P_NUMATR.
  LS_SAL-LV_DEDUCT = LS_SAL-LV_DEDUCT + LS_SAL-LV_SUBDP.


"POR FIM, JÁ TEMOS TODOS OS VALORES E AS LÓGICAS POR DETRÁS DELES...MENOS UM.
  "NOSSO SALÁRIO LÍQUIDO, QUE É NOSSO SALÁRIO BRUTO MENOS TODAS AS DEDUÇÕES TRIBUTÁRIAS...
  "AS DEDUÇÕES TRIBUTÁRIAS SÓ PODERIAM SER CALCULADAS EM TOTALIDADE APÓS SABER QUANTO CADA EMPREGADOR TERÁ DE DECLARAR PARA A SEGURANÇA SOCIAL E QUANTIFICAR OS SERVIÇOS QUE O EMPREGADOR ADERIU."
  "SENDO ASSIM, PODEMOS ADMITIR QUE:"

  LS_SAL-LV_SALIQ = LS_SAL-LV_SALBRUTO - LS_SAL-LV_DEDUCT + LS_SAL-LV_BONUS. "SALÁRIO LÍQUIDO É O SALÁRIO BRUTO MENOS AS DEDUÇÕES SALARIAIS(CARGAS TRIBUTÁRIAS E SERVIÇOS).

APPEND LS_SAL TO LT_SAL.

"----------------------------"
"----------------------------"
"TRATAMENTO DE TABELA INTERNA"
"----------EXIBIÇÃO----------"
"----------------------------"

  TRY.                                                                   "MANIPULAÇÃO E TRATAMENTO DE ERROS"
        CALL METHOD CL_SALV_TABLE=>FACTORY                               "O MÉTODO DA CLASSE FACTORY FOI CHAMADO PARA EXIBIR O RELATÓRIO ALV."
          IMPORTING                                                      "MINHA TABELA INTERNA FOI INTRODUZIDA PARA ESTE PROCESSO."
            R_SALV_TABLE = REPORTALV
          CHANGING
            T_TABLE      = LT_SAL.

        FUNCTIONS = REPORTALV->GET_FUNCTIONS( ).
        FUNCTIONS->SET_ALL( ABAP_TRUE ).

        CALL METHOD REPORTALV->DISPLAY( ).
      CATCH CX_SALV_MSG.
        MESSAGE 'Error to display ALV Report' TYPE 'S' DISPLAY LIKE 'I'.
    ENDTRY.


BREAK-POINT.
